
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Options Backtesting Library for Python">
      
      
        <meta name="author" content="Michael Chu">
      
      
        <link rel="canonical" href="https://michaelchu.github.io/optopsy/ideas/agent-backtesting-architecture-eval/">
      
      
      
      
        
          <link rel="alternate" href="./" hreflang="en">
        
          <link rel="alternate" href="../../zh/ideas/agent-backtesting-architecture-eval/" hreflang="zh">
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>AI Agent Backtesting Architecture Evaluation - Optopsy Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ai-agent-backtesting-architecture-evaluation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Optopsy Documentation" class="md-header__button md-logo" aria-label="Optopsy Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Optopsy Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AI Agent Backtesting Architecture Evaluation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh/ideas/agent-backtesting-architecture-eval/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/michaelchu/optopsy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    michaelchu/optopsy
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting-started/" class="md-tabs__link">
        
  
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../strategies/" class="md-tabs__link">
          
  
  
  Strategies

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../parameters/" class="md-tabs__link">
        
  
  
    
  
  Parameters

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../entry-signals/" class="md-tabs__link">
        
  
  
    
  
  Entry Signals

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../chat-ui/" class="md-tabs__link">
        
  
  
    
  
  AI Chat UI

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../api-reference/" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Optopsy Documentation" class="md-nav__button md-logo" aria-label="Optopsy Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Optopsy Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/michaelchu/optopsy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    michaelchu/optopsy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Strategies
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Strategies
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategies/singles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single-Leg Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategies/straddles-strangles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Straddles & Strangles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategies/spreads/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vertical Spreads
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategies/butterflies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Butterflies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategies/iron-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Iron Condors & Iron Butterflies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategies/covered/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Covered Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategies/calendars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Calendar Spreads
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategies/diagonals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diagonal Spreads
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parameters
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../entry-signals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entry Signals
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chat-ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Chat UI
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-works-well" class="md-nav__link">
    <span class="md-ellipsis">
      
        What works well
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What works well">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tool-decomposition-is-sound" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tool decomposition is sound
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#llmui-output-split-is-well-designed" class="md-nav__link">
    <span class="md-ellipsis">
      
        LLM/UI output split is well-designed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#signal-system-is-well-abstracted" class="md-nav__link">
    <span class="md-ellipsis">
      
        Signal system is well-abstracted
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strategy-coverage-is-comprehensive" class="md-nav__link">
    <span class="md-ellipsis">
      
        Strategy coverage is comprehensive
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structural-problems-for-exploration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Structural problems for exploration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Structural problems for exploration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-no-way-to-compare-results-across-runs" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. No way to compare results across runs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-single-active-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Single active dataset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-no-parameter-sweep-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. No parameter sweep tool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-no-derived-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. No derived metrics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-no-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. No visualization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-missing-iv-dimension" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Missing IV dimension
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-no-result-persistence-or-labeling" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. No result persistence or labeling
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smaller-issues" class="md-nav__link">
    <span class="md-ellipsis">
      
        Smaller issues
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommendations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recommendations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-compare_strategies-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. compare_strategies tool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-sweep_parameter-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. sweep_parameter tool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-result-memory" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Result memory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-richer-metrics-in-aggregated-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Richer metrics in aggregated output
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-preview_data-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. preview_data enhancements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-a-charting-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. A charting tool
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="ai-agent-backtesting-architecture-evaluation">AI Agent Backtesting Architecture Evaluation<a class="headerlink" href="#ai-agent-backtesting-architecture-evaluation" title="Permanent link">&para;</a></h1>
<p>An evaluation of the optopsy chat agent architecture for AI-driven options strategy exploration.</p>
<h2 id="what-works-well">What works well<a class="headerlink" href="#what-works-well" title="Permanent link">&para;</a></h2>
<h3 id="tool-decomposition-is-sound">Tool decomposition is sound<a class="headerlink" href="#tool-decomposition-is-sound" title="Permanent link">&para;</a></h3>
<p>The four core tools (<code>list_data_files</code>, <code>load_csv_data</code>/<code>fetch_eodhd_options</code>, <code>preview_data</code>, <code>run_strategy</code>) map cleanly to the data-load-then-backtest workflow. The agent doesn't have to manage DataFrames directly — it just passes parameter dicts and gets results back.</p>
<h3 id="llmui-output-split-is-well-designed">LLM/UI output split is well-designed<a class="headerlink" href="#llmui-output-split-is-well-designed" title="Permanent link">&para;</a></h3>
<p><code>ToolResult</code> with separate <code>llm_summary</code> and <code>user_display</code> is a good pattern. The LLM gets compact stats while the user sees full tables. This is critical for keeping token budgets manageable across multi-tool explorations.</p>
<h3 id="signal-system-is-well-abstracted">Signal system is well-abstracted<a class="headerlink" href="#signal-system-is-well-abstracted" title="Permanent link">&para;</a></h3>
<p>The 13 signals in <code>SIGNAL_REGISTRY</code> with string-name resolution and optional <code>params</code>/<code>days</code> overrides give the LLM a clean interface. The agent doesn't need to construct function objects — it just passes <code>"rsi_below"</code> and <code>{"threshold": 40}</code>.</p>
<h3 id="strategy-coverage-is-comprehensive">Strategy coverage is comprehensive<a class="headerlink" href="#strategy-coverage-is-comprehensive" title="Permanent link">&para;</a></h3>
<p>28 strategies covering single-leg, spreads, butterflies, iron condors, calendars, diagonals, covered calls, and protective puts. The parameterization (DTE, OTM%, slippage, signals) gives meaningful exploration axes.</p>
<h2 id="structural-problems-for-exploration">Structural problems for exploration<a class="headerlink" href="#structural-problems-for-exploration" title="Permanent link">&para;</a></h2>
<h3 id="1-no-way-to-compare-results-across-runs">1. No way to compare results across runs<a class="headerlink" href="#1-no-way-to-compare-results-across-runs" title="Permanent link">&para;</a></h3>
<p>This is the biggest gap. The agent's exploratory value depends on comparing strategies, parameters, or signals against each other. Currently:</p>
<ul>
<li>Each <code>run_strategy</code> call returns results independently.</li>
<li>History compaction truncates previous tool results to a single line after the next iteration.</li>
<li>The agent literally loses access to earlier backtest results mid-conversation.</li>
</ul>
<p>An exploration agent that can't hold multiple results in working memory and compare them is severely limited. The system prompt tells the agent to "run both strategies and compare", but the architecture actively works against this by compacting away the data it needs.</p>
<h3 id="2-single-active-dataset">2. Single active dataset<a class="headerlink" href="#2-single-active-dataset" title="Permanent link">&para;</a></h3>
<p><code>OptopsyAgent</code> holds one <code>self.dataset</code>. To compare SPY vs AAPL iron condors, the agent must:</p>
<ol>
<li>Fetch SPY, run strategy, mentally note results</li>
<li>Fetch AAPL (overwrites dataset), run strategy</li>
<li>Compare from (compacted) memory</li>
</ol>
<p>There's no multi-symbol workspace.</p>
<h3 id="3-no-parameter-sweep-tool">3. No parameter sweep tool<a class="headerlink" href="#3-no-parameter-sweep-tool" title="Permanent link">&para;</a></h3>
<p>The most common exploration question is "what DTE works best for short puts?" The agent's only option is calling <code>run_strategy</code> N times with different <code>max_entry_dte</code> values. With a 15-iteration cap and 1-second throttle per iteration, it can test at most ~6-7 parameter values before hitting the limit (each strategy run + the comparison response consume iterations).</p>
<p>A <code>sweep_parameter</code> tool that runs a strategy across a range of values and returns a comparison table would be far more efficient.</p>
<h3 id="4-no-derived-metrics">4. No derived metrics<a class="headerlink" href="#4-no-derived-metrics" title="Permanent link">&para;</a></h3>
<p>The aggregated output gives <code>count, mean, std, min, 25%, 50%, 75%, max</code> of <code>pct_change</code> — that's <code>DataFrame.describe()</code>. Missing for real exploration:</p>
<ul>
<li>Win rate (% of trades with positive pct_change)</li>
<li>Profit factor (gross profit / gross loss)</li>
<li>Max drawdown (sequential losses)</li>
<li>Sharpe-like ratio (mean / std is mentioned in the prompt but not computed)</li>
<li>Expected value per trade</li>
</ul>
<p>These are computable from raw trades but there's no tool to do it. The agent would have to request <code>raw=true</code>, get a 50-row-capped table, and try to compute metrics from truncated data.</p>
<h3 id="5-no-visualization">5. No visualization<a class="headerlink" href="#5-no-visualization" title="Permanent link">&para;</a></h3>
<p>Options exploration is inherently visual — P&amp;L profiles by strike, return distributions, DTE heatmaps. The Chainlit framework supports image/chart rendering, but no tool produces charts. The agent can only return markdown tables.</p>
<h3 id="6-missing-iv-dimension">6. Missing IV dimension<a class="headerlink" href="#6-missing-iv-dimension" title="Permanent link">&para;</a></h3>
<p>Implied volatility is the most important variable in options pricing, but it's absent from the tooling:</p>
<ul>
<li>EODHD data likely includes IV but it's not surfaced.</li>
<li>No IV rank/percentile filtering.</li>
<li>No vol surface analysis.</li>
<li>Can't answer "do iron condors work better in high-IV environments?" without IV data.</li>
</ul>
<h3 id="7-no-result-persistence-or-labeling">7. No result persistence or labeling<a class="headerlink" href="#7-no-result-persistence-or-labeling" title="Permanent link">&para;</a></h3>
<p>Each backtest is fire-and-forget. The agent can't say "save this as 'baseline'" and later "compare against baseline." For iterative exploration (tweak one parameter, compare), this forces the agent to re-run the baseline every time.</p>
<h2 id="smaller-issues">Smaller issues<a class="headerlink" href="#smaller-issues" title="Permanent link">&para;</a></h2>
<ul>
<li><code>run_strategy</code> is monolithic — it handles all 28 strategies plus signals plus slippage in one function. This means the agent can't compose intermediate steps (e.g., "filter the data to March, then run a strategy").</li>
<li>The 50-row cap on displayed results limits what the agent can analyze in raw mode.</li>
<li>Calendar/diagonal strategies have separate DTE parameters (<code>front_dte_min/max</code>, <code>back_dte_min/max</code>) but these are silently ignored for non-calendar strategies rather than raising an error, which could confuse the agent.</li>
<li>No tool to inspect the actual strikes/expirations available in data — <code>preview_data</code> shows shape and date range but not strike distribution or DTE histogram.</li>
</ul>
<h2 id="recommendations">Recommendations<a class="headerlink" href="#recommendations" title="Permanent link">&para;</a></h2>
<p>The highest-impact additions for exploration, roughly in priority order:</p>
<h3 id="1-compare_strategies-tool">1. <code>compare_strategies</code> tool<a class="headerlink" href="#1-compare_strategies-tool" title="Permanent link">&para;</a></h3>
<p>Accept a list of <code>(strategy_name, params)</code> tuples, run all of them on the current dataset, return a side-by-side comparison table with win rate, mean return, Sharpe, max drawdown, and trade count. This single tool would eliminate the most common multi-turn pattern.</p>
<h3 id="2-sweep_parameter-tool">2. <code>sweep_parameter</code> tool<a class="headerlink" href="#2-sweep_parameter-tool" title="Permanent link">&para;</a></h3>
<p>Accept a strategy, a parameter name, and a range of values. Return a table showing how the key metric changes across the parameter space. This turns a 10-iteration workflow into 1 call.</p>
<h3 id="3-result-memory">3. Result memory<a class="headerlink" href="#3-result-memory" title="Permanent link">&para;</a></h3>
<p>A lightweight dict of <code>{label: summary_stats}</code> that persists across the conversation and survives compaction. The agent can label results and refer back to them.</p>
<h3 id="4-richer-metrics-in-aggregated-output">4. Richer metrics in aggregated output<a class="headerlink" href="#4-richer-metrics-in-aggregated-output" title="Permanent link">&para;</a></h3>
<p>Add win rate, profit factor, and mean/std ratio to the default aggregated stats. These are trivial to compute from <code>pct_change</code> and would eliminate the need for raw-mode workarounds.</p>
<h3 id="5-preview_data-enhancements">5. <code>preview_data</code> enhancements<a class="headerlink" href="#5-preview_data-enhancements" title="Permanent link">&para;</a></h3>
<p>Include strike distribution (min/max/count by expiration), DTE histogram, and available option types. This helps the agent choose sensible parameters without trial-and-error.</p>
<h3 id="6-a-charting-tool">6. A charting tool<a class="headerlink" href="#6-a-charting-tool" title="Permanent link">&para;</a></h3>
<p>Even a simple matplotlib-to-PNG tool for return distributions and DTE/OTM heatmaps would add significant exploration value.</p>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>The architecture is solid for single-strategy, single-run backtesting — load data, run strategy, interpret results. But "exploring ideas" requires iteration, comparison, and memory, and those are the areas where the tooling falls short. The agent can technically explore by running strategies one at a time, but the 15-iteration cap, aggressive history compaction, single-dataset constraint, and lack of comparison/sweep tools make multi-hypothesis exploration slow and lossy. Adding 2-3 comparison-oriented tools would substantially improve the agent's ability to actually explore the strategy space.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "toc.follow", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>